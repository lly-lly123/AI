# 🚨 Zeabur服务崩溃问题快速诊断

## ⚠️ 当前状态

从Zeabur控制台看到：
- **服务状态**: `Crashed Retrying`（崩溃重试中）🔴
- **最新部署**: "更新推送GitHub说明文档:反映最新推送成功状态"
- **部署历史**: 显示多个失败的部署记录

## 🔍 立即诊断步骤

### 第1步：查看错误日志（最重要！）

**操作步骤：**
1. 在Zeabur控制台，点击 **"Logs"** 标签页（顶部导航栏）
2. 或者点击页面上的 **"Logs"** 卡片
3. **向下滚动**查看完整的日志内容
4. **查找红色错误信息**，重点关注：
   - 最后几行的错误
   - 包含 "Error"、"Failed"、"Cannot"、"undefined" 的行
   - 端口相关的错误（PORT、EADDRINUSE）

**请截图日志内容发给我，我会根据具体错误告诉您如何修复！**

---

## 🔧 常见崩溃原因和解决方案

### 原因1：缺少环境变量（最可能）

**错误特征：**
- `undefined` 相关错误
- API密钥相关错误
- 配置读取失败

**解决方案：**
1. 在Zeabur控制台，点击 **"Variable"** 标签页
2. 添加以下环境变量（至少一个）：
   ```
   ZHIPU_API_KEY_EVO=你的智谱API密钥
   ```
   或
   ```
   ZHIPU_API_KEY_ADMIN=你的智谱API密钥
   ```
   或
   ```
   ZHIPU_API_KEY=你的智谱API密钥
   ```
3. 点击 **"Save"** 保存
4. 返回 **"Overview"** 页面
5. 点击 **"Redeploy"** 重新部署

---

### 原因2：启动命令配置错误

**错误特征：**
- `command not found`
- `npm: command not found`
- 路径相关错误

**检查步骤：**
1. 点击 **"Settings"** 标签页
2. 检查 **"Start Command"** 字段
3. **正确配置应该是：**
   ```
   cd backend && npm start
   ```
   或
   ```
   npm start
   ```
4. 确保没有中文输入法导致的错误（如 `cd后端&&npm启动`）
5. 保存后重新部署

---

### 原因3：依赖安装失败

**错误特征：**
- `Cannot find module 'xxx'`
- `npm install` 失败
- 模块缺失错误

**解决方案：**
1. 检查 `backend/package.json` 是否包含所有依赖
2. 在Zeabur的 **"Settings"** 中，检查 **"Build Command"**：
   ```
   cd backend && npm install
   ```
3. 如果没有Build Command，添加上述命令
4. 重新部署

---

### 原因4：端口配置问题

**错误特征：**
- `EADDRINUSE`
- `PORT is not defined`
- 端口绑定失败

**解决方案：**
代码已自动适配Zeabur的PORT环境变量，通常不需要手动配置。但如果出现问题：
1. 在 **"Variable"** 标签页添加：
   ```
   PORT=3000
   ```
2. 重新部署

---

### 原因5：数据库连接失败

**错误特征：**
- Supabase连接错误
- 数据库相关错误

**解决方案：**
- 如果只是数据库连接失败，服务应该可以降级运行
- 检查Supabase环境变量配置（可选）
- 如果不需要数据库功能，可以暂时不配置

---

## 📋 快速检查清单

在查看日志前，先检查这些配置：

- [ ] **环境变量已配置**（至少一个API密钥）
  - 位置：Zeabur控制台 → Variable标签页
  - 需要：`ZHIPU_API_KEY_EVO` 或 `ZHIPU_API_KEY_ADMIN` 或 `ZHIPU_API_KEY`

- [ ] **启动命令正确**
  - 位置：Zeabur控制台 → Settings标签页
  - 应该是：`cd backend && npm start`

- [ ] **根目录设置正确**
  - 位置：Zeabur控制台 → Settings标签页
  - 应该是：`.` 或留空

- [ ] **代码已推送**
  - 确认GitHub仓库有最新代码

---

## 🚀 修复后的操作

1. **修复配置后**，点击 **"Redeploy"** 按钮
2. **等待部署完成**（通常1-3分钟）
3. **查看Logs**，确认看到：
   - ✅ `服务器启动成功: http://0.0.0.0:端口号`
   - ✅ 没有红色错误信息
4. **检查服务状态**，应该变为 `Running`（运行中）🟢

---

## 📸 需要的信息

为了准确诊断问题，请提供：

1. **Logs标签页的完整截图**（特别是错误部分）
2. **Variable标签页的截图**（查看环境变量配置）
3. **Settings标签页的截图**（查看启动命令等配置）

---

## 💡 提示

- 大多数崩溃问题都是**缺少环境变量**导致的
- 确保API密钥已正确配置
- 查看日志是最重要的诊断步骤
- 修复配置后一定要点击 **"Redeploy"** 重新部署

---

**下一步：请查看Logs标签页，截图错误信息发给我！** 🔍





